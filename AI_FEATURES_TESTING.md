# AI 기능 테스트 가이드

## 📋 개요

APAS 시스템의 AI 기능을 테스트하기 위한 가이드입니다. 세 가지 주요 AI 기능을 테스트할 수 있습니다:

1. **문서 분석** - AI가 업로드된 문서를 분석하여 목차, 요약, 주요 주제 추출
2. **콘텐츠 생성** - AI가 보고서 섹션 내용을 전문적으로 생성
3. **AI 채팅** - 대화형 AI 어시스턴트와 상호작용

## 🚀 빠른 시작

### 1. 서버 실행 확인

**Backend (포트 4000)**

```bash
cd backend
npm run dev
```

**Frontend (포트 3000 또는 3001)**

```bash
cd frontend
npm run dev
```

### 2. 로그인

1. 브라우저에서 `http://localhost:3000` (또는 3001) 접속
2. 회원가입 또는 로그인

### 3. 프로젝트 생성

1. "새 프로젝트" 클릭
2. 프로젝트 정보 입력:
   - 프로젝트명: "수자원 기본계획서"
   - 프로젝트 유형: "수자원 기본계획"
   - 설명: "2024년 수자원 기본계획서 작성"

### 4. 문서 업로드 (선택사항)

> **참고**: 현재 로컬 개발 환경에서는 파일 업로드가 Supabase Storage를 사용하도록 설정되어 있습니다.
> 실제 파일 업로드 테스트를 위해서는 Supabase 연결이 필요합니다.
>
> **대안**: 문서 없이도 AI 기능(콘텐츠 생성, AI 채팅)을 테스트할 수 있습니다.

만약 파일 업로드를 테스트하려면:

1. "파일 추가" 클릭
2. PDF 또는 DOCX 파일 드래그 앤 드롭 또는 선택
3. 업로드 완료 대기

## 🧪 AI 기능 테스트

### 테스트 1: 문서 분석

**목적**: AI가 문서를 분석하여 구조와 내용을 파악하는지 확인

**단계**:

1. 프로젝트 상세 페이지에서 **"✨ AI 기능 사용하기"** 버튼 클릭
2. **"문서 분석"** 탭 선택 (기본값)
3. 문서를 업로드했다면:
   - 분석할 문서 선택
   - **"분석 시작"** 버튼 클릭
   - 결과 대기 (1-2분 소요)

**기대 결과**:

```
✅ 문서 정보 표시
   - 문서 유형: "수자원 기본계획서"
   - 언어: "Korean"
   - 예상 페이지 수
   - 예상 단어 수

✅ 문서 요약
   - AI가 생성한 문서 요약 텍스트

✅ 주요 주제
   - 추출된 키워드 태그들

✅ 목차 (Table of Contents)
   - 계층적 구조로 표시된 문서 목차
   - 페이지 번호 포함
```

**API 엔드포인트**:

```bash
# 문서 분석 실행
curl -X POST http://localhost:4000/analysis/documents/{documentId} \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# 분석 결과 조회
curl -X GET http://localhost:4000/analysis/documents/{documentId} \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

---

### 테스트 2: 콘텐츠 생성

**목적**: AI가 보고서 섹션 내용을 전문적으로 생성하는지 확인

**단계**:

1. **"콘텐츠 생성"** 탭 클릭
2. 폼 작성:
   - **섹션 제목**: "1. 사업 개요"
   - **섹션 설명** (선택사항): "사업의 배경, 목적, 추진 경과를 포함"
3. **"콘텐츠 생성"** 버튼 클릭
4. 결과 대기 (30초~1분)

**기대 결과**:

```
✅ 생성된 콘텐츠 표시
   - 섹션 제목
   - AI가 생성한 전문적인 텍스트 내용
   - 버전 번호
   - 생성 일시

✅ 콘텐츠 개선 옵션
   - ✓ 문법 교정
   - 💡 명확성 향상
   - 👔 전문성 강화
   - 📝 간결하게

✅ 액션 버튼
   - "복사" - 클립보드에 복사
   - "새 콘텐츠 생성" - 새로 생성
```

**개선 기능 테스트**:

1. 생성된 콘텐츠에서 개선 옵션 중 하나 클릭 (예: "전문성 강화")
2. AI가 콘텐츠를 개선한 새 버전 생성
3. 버전 번호가 증가하는지 확인

**API 엔드포인트**:

```bash
# 콘텐츠 생성
curl -X POST http://localhost:4000/content/generate \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "projectId": "PROJECT_ID",
    "sectionTitle": "1. 사업 개요",
    "sectionDescription": "사업의 배경과 목적을 설명"
  }'

# 콘텐츠 개선
curl -X POST http://localhost:4000/content/{contentId}/improve \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "improvementType": "professional"
  }'
```

---

### 테스트 3: AI 채팅

**목적**: 대화형 AI 어시스턴트와 실시간 상호작용 확인

**단계**:

1. **"AI 채팅"** 탭 클릭
2. 메시지 입력 예시:
   - "이 프로젝트의 목표를 3가지로 요약해줘"
   - "사업 개요 섹션을 더 전문적으로 작성해줘"
   - "추진 일정표를 만들어줘"
3. Enter 키로 전송 (Shift+Enter는 줄바꿈)
4. AI 응답 대기

**기대 결과**:

```
✅ 대화 인터페이스
   - 사용자 메시지 (파란색, 오른쪽)
   - AI 응답 (회색, 왼쪽)
   - 타임스탬프 표시

✅ 실시간 피드백
   - 로딩 중 애니메이션 (점 3개)
   - AI 응답이 대화 히스토리에 추가됨

✅ 대화 관리
   - "새 대화" 버튼으로 대화 초기화
   - 대화 컨텍스트 유지 (conversationId)
```

**키보드 단축키**:

- **Enter**: 메시지 전송
- **Shift + Enter**: 줄바꿈

**API 엔드포인트**:

```bash
# AI 채팅
curl -X POST http://localhost:4000/content/chat \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "projectId": "PROJECT_ID",
    "message": "이 프로젝트의 목표를 3가지로 요약해줘",
    "conversationId": null
  }'
```

---

## 🔍 테스트 시나리오

### 시나리오 1: 전체 워크플로우

1. 새 프로젝트 생성
2. (선택) 참고 문서 업로드
3. AI로 문서 분석 실행
4. 분석 결과 확인 (목차, 요약)
5. 콘텐츠 생성으로 "사업 개요" 섹션 작성
6. "전문성 강화"로 콘텐츠 개선
7. AI 채팅으로 추가 질문 ("추진 일정은?")
8. 생성된 콘텐츠 복사

### 시나리오 2: 문서 없이 AI 활용

1. 빈 프로젝트 생성
2. 콘텐츠 생성 탭에서 여러 섹션 작성:
   - "1. 사업 개요"
   - "2. 추진 배경"
   - "3. 추진 목표"
3. 각 콘텐츠를 다양한 방식으로 개선
4. AI 채팅으로 추가 가이드 받기

### 시나리오 3: AI 채팅 집중 테스트

1. AI 채팅 탭 열기
2. 연속 대화:

   ```
   사용자: "수자원 기본계획서 구조를 알려줘"
   AI: [응답]

   사용자: "각 섹션별 주요 내용은?"
   AI: [응답]

   사용자: "사업 개요를 500자로 작성해줘"
   AI: [응답]
   ```

3. "새 대화" 클릭 후 새 주제로 대화 시작

---

## ⚠️ 알려진 제한사항

### 1. 파일 업로드

- **현재 상태**: Supabase Storage 사용 설정
- **로컬 테스트**: Supabase 연결 필요
- **대안**: 문서 없이 콘텐츠 생성 및 AI 채팅 테스트 가능

### 2. 문서 분석

- **요구사항**: 실제 문서 업로드 필요
- **처리 시간**: 대용량 문서는 1-2분 소요
- **대안**: 콘텐츠 생성과 AI 채팅은 문서 없이 사용 가능

### 3. API 응답 시간

- **Gemini API**: 일반적으로 빠름 (5-15초)
- **Claude API**: 긴 응답은 30초~1분 소요
- **네트워크**: API 호출은 인터넷 연결 필요

---

## 🐛 트러블슈팅

### 문제 1: AI 기능 페이지가 로딩되지 않음

**해결**:

```bash
# Frontend 서버 재시작
cd frontend
npm run dev
```

### 문제 2: "문서를 불러올 수 없습니다" 에러

**원인**: Backend 서버가 실행 중이지 않음

**해결**:

```bash
# Backend 상태 확인
curl http://localhost:4000/health

# Backend 서버 재시작
cd backend
npm run dev
```

### 문제 3: AI API 에러 (500 Internal Server Error)

**원인**: API 키 설정 문제 또는 API 할당량 초과

**확인**:

```bash
# backend/.env 파일 확인
cat backend/.env | grep API_KEY

# API 키가 올바르게 설정되어 있는지 확인
GEMINI_API_KEY=AIzaSyCiaGcHqn69onapYYmdnj8g69ZhmeBZDqs
CLAUDE_API_KEY=sk-ant-api03-...
```

### 문제 4: "Unauthorized" 에러

**원인**: 로그인 토큰 만료

**해결**:

1. 로그아웃
2. 다시 로그인
3. AI 기능 재시도

### 문제 5: CORS 에러

**원인**: Frontend 포트와 Backend CORS 설정 불일치

**확인**:

```bash
# backend/.env 확인
CORS_ORIGIN=http://localhost:3001

# Frontend가 3000포트라면 .env 수정
CORS_ORIGIN=http://localhost:3000
```

---

## 📊 성공 체크리스트

### 기본 기능

- [ ] 로그인 성공
- [ ] 프로젝트 생성
- [ ] AI 기능 페이지 접근
- [ ] 세 가지 탭 전환 (문서 분석, 콘텐츠 생성, AI 채팅)

### 문서 분석 (문서 업로드 시)

- [ ] 문서 업로드 성공
- [ ] 분석 시작
- [ ] 분석 결과 표시 (요약, 주제, 목차)
- [ ] 새로고침 버튼 작동

### 콘텐츠 생성

- [ ] 섹션 정보 입력
- [ ] 콘텐츠 생성 성공
- [ ] 생성된 텍스트 표시
- [ ] 4가지 개선 옵션 작동
- [ ] 복사 버튼 작동
- [ ] 버전 번호 증가 확인

### AI 채팅

- [ ] 메시지 전송
- [ ] AI 응답 수신
- [ ] 대화 히스토리 유지
- [ ] 타임스탬프 표시
- [ ] 새 대화 시작
- [ ] Enter/Shift+Enter 단축키

---

## 💡 테스트 팁

1. **API 키 할당량**: Claude API는 무료 티어가 제한적입니다. 테스트 시 간단한 요청부터 시작하세요.

2. **응답 시간**: 첫 번째 AI 요청은 느릴 수 있습니다 (모델 로딩). 이후 요청은 더 빠릅니다.

3. **콘텐츠 품질**: 섹션 설명을 상세히 작성할수록 더 정확한 콘텐츠가 생성됩니다.

4. **대화 컨텍스트**: AI 채팅은 대화 히스토리를 유지하므로, 연관된 질문을 연속으로 할 수 있습니다.

5. **에러 메시지**: 에러 발생 시 브라우저 개발자 도구(F12)의 Console과 Network 탭을 확인하세요.

---

## 📝 다음 단계

AI 기능 테스트 완료 후:

1. **문서 편집 기능** 개발 및 테스트
2. **Export 기능** (PDF/DOCX 생성)
3. **Supabase 연동** (파일 업로드 정상 작동)
4. **프로덕션 배포** 준비

---

## 🔗 관련 문서

- [LOCAL_TESTING.md](./LOCAL_TESTING.md) - 로컬 개발 환경 설정
- [TESTING_GUIDE.md](./TESTING_GUIDE.md) - 전체 시스템 테스트 가이드
- [backend/.env](./backend/.env) - 환경 변수 설정

---

**작성일**: 2024년 11월 12일
**버전**: 1.0
**상태**: 초안
